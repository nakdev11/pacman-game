# パックマン風ゲーム 設計書

## 1. 概要
シンプルなパックマン風のゲームをWebブラウザ上で実装します。最初のバージョンでは、以下の基本機能を実装します。

## 2. ゲームの仕様

### 2.1 ゲーム画面
- キャンバスサイズ: 600x600ピクセル
- グリッドサイズ: 20x20マス（1マス=30x30ピクセル）

### 2.2 ゲーム要素

#### 2.2.1 パックマン
- 黄色い円形のキャラクター
- キーボードの矢印キー（↑↓←→）で上下左右に移動
- 口をパクパクさせるアニメーション
- 移動方向に応じて向きが変わる
- 滑らかな移動（グリッド単位ではなくピクセル単位での移動）

#### 2.2.2 迷路
- 壁は青色の四角形で表現
- パックマンは壁を通り抜けられない
- 「ツム」の文字が浮かび上がるデザイン
- 迷路の例：
  ```
  ####################
  #..................#
  #.#.#.#............#
  #.#.#.#............#
  #.....#............#
  #....#.............#
  #...#..............#
  #......#...........#
  #.....#............#
  #....#....#........#
  #...#######........#
  #.............#.#..#
  #..........#.......#
  #........#####.....#
  #..........#.......#
  #........#####.....#
  #..........#.......#
  #..........#.......#
  #..................#
  ####################
  ```

#### 2.2.3 ドット
- 白い小さな円形（グリッドの中央に配置）
- パックマンが近づくと取得される
- 1つ取得するごとに1点加算
- 取得済みのドットは表示されない

### 2.3 ゲームの流れ
1. ゲーム開始時に迷路とドット、パックマンを配置
2. プレイヤーは矢印キーでパックマンを操作
3. パックマンがドットに近づくとドットが消え、スコアが加算
4. すべてのドットを取得するとゲームクリア
5. Rキーでいつでもゲームをリセット可能

## 3. 技術仕様

### 3.1 使用技術
- HTML5 Canvas: ゲーム画面の描画
- JavaScript (ES6+): ゲームロジック
- CSS: 基本的なスタイリング

### 3.2 ファイル構成
```
pacman-game/
├── index.html      # ゲームのメインHTML
├── css/
│   └── style.css   # スタイルシート
└── js/
    ├── game.js     # ゲームのメインロジック
    ├── pacman.js   # パックマンクラス（移動・描画）
    ├── maze.js     # 迷路クラス（壁の管理・描画）
    └── dot.js      # ドットクラス（ドットの管理・描画）
```

### 3.3 クラス設計

#### 3.3.1 Game クラス
- ゲーム全体の状態管理
- ゲームループの実行
- キーボード入力の処理
- スコア管理
- ゲームのリセット機能

#### 3.3.2 Pacman クラス
- 位置情報（ピクセル単位）
- 移動方向と次の移動方向の管理
- アニメーション状態（口の開閉）
- グリッドベースの移動処理
- 滑らかな移動のための補間処理

#### 3.3.3 Maze クラス
- 迷路データの管理（壁の位置）
- 壁の描画
- 移動可能判定
- グリッドベースの位置判定

#### 3.3.4 Dot クラス
- ドットの位置（グリッド単位）
- 取得状態の管理
- ドットの描画

## 4. 実装の詳細

### 4.1 パックマンの移動システム
- グリッドの中央で方向転換を判定
- スムーズな移動のためのピクセル単位の位置管理
- 壁衝突時の処理

### 4.2 当たり判定
- パックマンとドットの距離ベースの判定
- 壁との衝突判定（グリッドベース）

### 4.3 描画システム
- ダブルバッファリングによる滑らかなアニメーション
- パックマンの回転アニメーション
- 効率的な再描画処理

## 5. 今後の拡張案

- ゴーストの追加（敵キャラクター）
- パワーエサの実装（一時的にゴーストを食べられる）
- 複数のステージの実装
- サウンドエフェクトの追加
- ハイスコアの保存（localStorageを使用）
- スタート画面とゲームオーバー画面の追加
- レスポンシブデザインの対応（様々な画面サイズへの対応）
